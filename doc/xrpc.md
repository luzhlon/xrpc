
## XRPC协议

* 使用WebSocket协议通信
* 使用MsgPack格式传输数据包

## 数据包格式

XRPC协议基于msgpack，每一个数据包都是一个msgpack的array对象，其**通用格式**为

```
+-----------+---------+- - - - - - -+---------
| is invoke | pack id | function id | data
+-----------+---------+- - - - - - -+---------
```

`第0个`值指定了这是一个`调用数据包`还是一个`返回数据包`，`第1个`值指定了调用方数据包的id，如果此值为0的话，则表明这是一个`信号数据包`(不需要返回值的调用数据包)

所以，XRPC协议的数据包有**三种基本格式**:

* '调用'数据包
```
+---------+---------+-------------+---------
| true    | > 0     | function id | args...
+---------+---------+-------------+---------
```
* '信号'数据包
```
+---------+---------+-------------+---------
| true    | 0       | function id | args...
+---------+---------+-------------+---------
```
* '返回'数据包
```
+---------+---------+-------------+
| false   | pack id | value       |
+---------+---------+-------------+
```

在'调用'包和'信号'包中，`function id`代表的是'要调用的函数的ID'，其类型可以为整数或者字符串，后面的若干个值为调用此函数(信号)的参数；
在'返回'包中，`pack id`为之前发送的'调用'包的一个ID，此ID必大于0，因为'信号'包是没有返回值的，value为调用对方某个函数后的返回值
